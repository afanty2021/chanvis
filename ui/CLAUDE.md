[æ ¹ç›®å½•](../../CLAUDE.md) > **ui**

# UI å‰ç«¯æ¨¡å—

> æ›´æ–°æ—¶é—´ï¼š2025-12-10 12:19:50

## æ¨¡å—èŒè´£

UI æ¨¡å—æ˜¯ ChanVis é¡¹ç›®çš„å‰ç«¯å±•ç¤ºå±‚ï¼ŒåŸºäº Vue.js 2.5 å’Œ TradingView Charting Library æ„å»ºã€‚ä¸»è¦è´Ÿè´£ï¼š
- é›†æˆ TradingView ä¸“ä¸šå›¾è¡¨ç»„ä»¶
- å±•ç¤º K çº¿æ•°æ®å’Œç¼ è®ºåˆ†æç»“æœ
- æä¾›ç”¨æˆ·äº¤äº’ç•Œé¢
- ä¸åç«¯ API è¿›è¡Œæ•°æ®é€šä¿¡

## å…¥å£ä¸å¯åŠ¨

### é¡¹ç›®ç»“æ„
```
ui/
â”œâ”€â”€ public/             # é™æ€èµ„æºç›®å½•
â”‚   â”œâ”€â”€ index.html     # HTMLæ¨¡æ¿
â”‚   â”œâ”€â”€ put-charting-library-here  # TradingViewåº“ç›®å½•æç¤º
â”‚   â””â”€â”€ put-datafeeds-here         # Datafeedsç»„ä»¶ç›®å½•æç¤º
â”œâ”€â”€ src/               # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ main.js        # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ main.css       # å…¨å±€æ ·å¼
â”‚   â”œâ”€â”€ ChanApp.vue    # æ ¹ç»„ä»¶
â”‚   â””â”€â”€ components/    # ç»„ä»¶ç›®å½•
â”‚       â””â”€â”€ ChanContainer.vue  # TradingViewå›¾è¡¨å®¹å™¨
â”œâ”€â”€ package.json       # é¡¹ç›®é…ç½®å’Œä¾èµ–
â””â”€â”€ README.md          # éƒ¨ç½²è¯´æ˜
```

### å¯åŠ¨æ–¹å¼
```bash
# å®‰è£…ä¾èµ–
npm install
# æˆ–ä½¿ç”¨ yarn
yarn install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run serve
# æˆ–
yarn serve
```

### è®¿é—®åœ°å€
http://127.0.0.1:8080

## å¯¹å¤–æ¥å£

### 1. ChanApp.vue - åº”ç”¨æ ¹ç»„ä»¶
- **è·¯å¾„**: `src/ChanApp.vue`
- **åŠŸèƒ½**: åº”ç”¨ç¨‹åºçš„å…¥å£ç»„ä»¶
- **å­ç»„ä»¶**: ChanContainer

### 2. ChanContainer.vue - å›¾è¡¨å®¹å™¨ç»„ä»¶
- **è·¯å¾„**: `src/components/ChanContainer.vue`
- **åŠŸèƒ½**:
  - åˆå§‹åŒ– TradingView Widget
  - é…ç½®å›¾è¡¨å‚æ•°
  - å¤„ç†ä¸åç«¯ API çš„æ•°æ®é€šä¿¡
  - è‡ªå®šä¹‰å›¾è¡¨åŠŸèƒ½

### ä¸»è¦é…ç½®å‚æ•°
```javascript
props: {
    symbol: '000001.XSHG',      // é»˜è®¤äº¤æ˜“å“ç§
    interval: '1D',            // é»˜è®¤æ—¶é—´å‘¨æœŸ
    containerId: 'tv_chart_container',  // å®¹å™¨ID
    datafeedUrl: 'http://127.0.0.1:8421/api',  // APIåœ°å€
    libraryPath: '/charting_library/',  // TVåº“è·¯å¾„
    chartsStorageUrl: 'http://127.0.0.1:8000',  // å›¾è¡¨å­˜å‚¨
    clientId: 'quantchan.com',  // å®¢æˆ·ç«¯ID
    userId: 'baihuo',          // ç”¨æˆ·ID
    fullscreen: false,         // å…¨å±æ¨¡å¼
    autosize: true             // è‡ªé€‚åº”å¤§å°
}
```

## å…³é”®ä¾èµ–ä¸é…ç½®

### TradingView é›†æˆ
- **Charting Library**: éœ€è¦æ”¾ç½®åœ¨ `public/charting_library/`
- **Datafeeds**: éœ€è¦æ”¾ç½®åœ¨ `public/datafeeds/`
- **ç‰ˆæœ¬è¦æ±‚**: åŸºäº charting_library-master-v17.025

### ä¾èµ–åŒ…æ¸…å•
æ¥è‡ª `package.json`ï¼š
- **vue**: 2.5.17 - å‰ç«¯æ¡†æ¶
- **axios**: 0.21.0 - HTTP è¯·æ±‚åº“
- **@vue/cli-service**: 3.9.3 - æ„å»ºå·¥å…·
- **node-sass**: 4.14.1 - Sass é¢„å¤„ç†å™¨
- **babel-core**: 6.26.3 - JS ç¼–è¯‘å™¨

### å¼€å‘å·¥å…·é…ç½®
- **ESLint**: ä»£ç è´¨é‡æ£€æŸ¥
- **Babel**: ES6+ è½¬è¯‘
- **Autoprefixer**: CSS å…¼å®¹æ€§å¤„ç†
- **Sass**: CSS é¢„å¤„ç†å™¨æ”¯æŒ

## æ•°æ®æ¨¡å‹

### ä¸åç«¯é€šä¿¡
é€šè¿‡ UDFCompatibleDatafeed ä¸åç«¯ API é€šä¿¡ï¼š
- å†å²æ•°æ®: `/api/history`
- å®æ—¶æ•°æ®: `/api/quote`
- å“ç§ä¿¡æ¯: `/api/symbols`
- é…ç½®ä¿¡æ¯: `/api/config`
- æ ‡è®°æ•°æ®: `/api/marks`

### è‡ªå®šä¹‰åŠŸèƒ½
- æ—¶é—´æ ¼å¼åŒ–å™¨ (customFormatters.timeFormatter)
- æ”¯æŒçš„æ—¶é—´å‘¨æœŸ: ["1", "5", "30", "240", "D"]
- ç ”ç©¶æ¨¡æ¿æ”¯æŒ (study_templates)

## æµ‹è¯•ä¸è´¨é‡

### å½“å‰çŠ¶æ€
- âœ… åŸºç¡€å›¾è¡¨åŠŸèƒ½å·²å®ç°
- âœ… TradingView é›†æˆå®Œæˆ
- âŒ ç¼ºå°‘å•å…ƒæµ‹è¯•
- âŒ ç¼ºå°‘ç»„ä»¶æµ‹è¯•
- âŒ ç¼ºå°‘ E2E æµ‹è¯•

### æµ‹è¯•å»ºè®®
1. **ç»„ä»¶æµ‹è¯•**: ä½¿ç”¨ Vue Test Utils æµ‹è¯•ç»„ä»¶åŠŸèƒ½
2. **E2Eæµ‹è¯•**: ä½¿ç”¨ Cypress æµ‹è¯•å®Œæ•´ç”¨æˆ·æµç¨‹
3. **APIé›†æˆæµ‹è¯•**: æµ‹è¯•ä¸åç«¯çš„æ•°æ®äº¤äº’
4. **æµè§ˆå™¨å…¼å®¹æ€§æµ‹è¯•**: æµ‹è¯•ä¸åŒæµè§ˆå™¨çš„è¡¨ç°

### å·²çŸ¥é—®é¢˜
1. Kçº¿æœªåŠ è½½å®Œæˆæ—¶å¯èƒ½å‡ºç°ç”»çº¿é”™è¯¯
2. éœ€è¦åˆ·æ–°é¡µé¢è§£å†³æŸäº›æ˜¾ç¤ºé—®é¢˜
3. ç¼ºå°‘é”™è¯¯å¤„ç†å’Œç”¨æˆ·æç¤º

## å¸¸è§é—®é¢˜ (FAQ)

### Q: TradingView SDK ä»å“ªé‡Œè·å–ï¼Ÿ
A: éœ€è¦ä»å®˜æ–¹ç”³è¯·ï¼šhttps://github.com/tradingview/charting_library/

### Q: å¦‚ä½•ä¿®æ”¹é»˜è®¤äº¤æ˜“å“ç§ï¼Ÿ
A: ä¿®æ”¹ `ChanContainer.vue` ä¸­çš„ symbol é»˜è®¤å€¼

### Q: å¦‚ä½•æ·»åŠ è‡ªå®šä¹‰æŒ‡æ ‡ï¼Ÿ
A: é€šè¿‡ TradingView çš„ studies_overrides é…ç½®æ·»åŠ 

### Q: å›¾è¡¨æ˜¾ç¤ºå¼‚å¸¸æ€ä¹ˆåŠï¼Ÿ
A:
1. æ£€æŸ¥ TradingView åº“æ˜¯å¦æ­£ç¡®æ”¾ç½®
2. æ£€æŸ¥ API æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ
3. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯

### Q: å¦‚ä½•å®ç°å›¾è¡¨ä¿å­˜åŠŸèƒ½ï¼Ÿ
A: éœ€è¦é›†æˆ TradingView çš„ saveload_backend åŠŸèƒ½

## ç›¸å…³æ–‡ä»¶æ¸…å•

```
ui/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ ChanApp.vue                   # æ ¹ç»„ä»¶
â”‚   â”œâ”€â”€ main.js                       # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ main.css                      # å…¨å±€æ ·å¼
â”‚   â””â”€â”€ components/
â”‚       â””â”€â”€ ChanContainer.vue         # TradingViewå›¾è¡¨å®¹å™¨
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ index.html                    # HTMLæ¨¡æ¿
â”‚   â””â”€â”€ [éœ€æ”¾ç½® TradingView ç›¸å…³æ–‡ä»¶]
â”œâ”€â”€ package.json                      # é¡¹ç›®é…ç½®
â””â”€â”€ README.md                         # éƒ¨ç½²è¯´æ˜
```

## å˜æ›´è®°å½• (Changelog)

### 2025-12-10 12:19:50
- âœ¨ åˆ›å»º UI æ¨¡å—æ–‡æ¡£
- ğŸ“‹ æ•´ç†ç»„ä»¶ç»“æ„å’Œé…ç½®è¯´æ˜
- ğŸ”§ æ˜ç¡® TradingView é›†æˆè¦æ±‚
- ğŸ’¡ æ·»åŠ æµ‹è¯•å»ºè®®å’Œé—®é¢˜è§£å†³æ–¹æ¡ˆ

---

*è¿”å›[æ ¹ç›®å½•](../../CLAUDE.md)*